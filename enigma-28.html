<!DOCTYPE html><html lang="es">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Enigma 28 | Kriptópolis</title>
<meta charset="utf-8">
<meta content="Enigma 28" about="/engima-28" property="dc:title">
<meta about="/engima-28" property="sioc:num_replies" content="0" datatype="xsd:integer">
<meta name="Generator" content="Drupal 7 (http://drupal.org)">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="MobileOptimized" content="width">
<meta name="HandheldFriendly" content="true">
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="next" href="https://kriptopolis.github.io/enigma/enigma-29.html">
<link rel="prev" href="https://kriptopolis.github.io/enigma/enigma-27.html">
<link rel="shortcut icon" href="https://kriptopolis.github.io/favicon.ico" type="image/x-icon">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css">
<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css">
<link type="text/css" rel="stylesheet" href="https://kriptopolis.github.io/enigma/style.css">
</head>
<body><div class="container">
<header id="header" class="clearfix"><div id="branding">
<div id="logo"><a href="https://kriptopolis.github.io/" title="Página de inicio"><img src="https://kriptopolis.github.io/kriptopolis.png" alt="Kriptópolis logo"></a></div>
<hgroup><h1 id="site-name"><a href="https://kriptopolis.github.io/" title="Página de inicio">Kriptópolis</a></h1>
<h2 id="site-slogan">Criptografía y Seguridad</h2></hgroup>
</div>
<!-- /header region --></header><section id="main-content"><header class="clearfix"><h1 id="page-title">Enigma 28</h1></header><article id="article-241" class="article article-type-book article-lang-es odd article-full clearfix" about="/engima-28" typeof="sioc:Item foaf:Document" role="article"><footer class="submitted"><span property="dc:date dc:created" content="2012-06-03T13:21:15+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/89" typeof="sioc:UserAccount" property="foaf:name">Roman</span> en <time datetime="2012-06-03T13:21:15Z" pubdate="pubdate">Dom, 03/06/2012 - 1:21pm</time></span></footer><div class="article-content">
<div class="field field-name-body field-type-text-with-summary field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded">
<p><em>Por Román Ceano</em></p>
<p>En esto estaba cuando se presentó Josh Cooper, de la sección aérea. Era un hombre alto y muy amanerado, que llevaba en el servicio desde mediados de los años 20, cuando fue reclutado por su amigo Knox. Compartía con este último los momentos de ausencia, en los que estaba tan concentrado que apenas sí se daba cuenta de lo que hacía, cosa que le acarreaba situaciones embarazosas.</p>
<p>Un día, por ejemplo, estaba tomando una taza de té dentro de la mansión y tuvo una idea. Mientras le daba vueltas, salió al jardín y se alejó. Llegó hasta el lago y allí alguien le hizo notar que tenía una taza vacía en la mano, de la que seguía bebiendo sorbos. Cooper se sobresaltó como un sonámbulo despertado a destiempo, miró la taza y, sin encontrar ninguna forma mejor de reaccionar, la arrojó al lago. Abochornado aún más por un gesto tan absurdo, se alejó a grandes zancadas.</p>
<p>Cooper tenía motivos para abstraerse, ya que intentaba resolver mensajes de la Enigma militar usada por el ejército del aire alemán a base de <em>rodding</em>, y desde luego no tenía las cosas fáciles.</p>
<p>Con gran circunspección, Cooper le dijo que le acompañara a la mansión, donde le enseñaría algo. Una vez allí, le dejó acceder a una sala en la que había unos mensajes decodificados, sin decirle de dónde los habían sacado. Sí que comentó que provenían de una fuente sobre el terreno, y que a pesar de disponer de las parejas cifrado-texto en claro, esto no había hecho avanzar el método de descifrado ni aumentado su efectividad.</p>
<p>Whelchman se pasó varias horas estudiándolos, hasta que le invitaron a irse. Aunque no sabía mucho alemán, sacó dos conclusiones importantes. La primera fue que los alemanes eran muy ceremoniosos y siempre se dirigían unos a otros con los títulos completos de cada uno mediante fórmulas muy estereotipadas. Por tanto se podían sacar conclusiones de que ciertas palabras estarían en el texto si se había identificado al receptor, lo cual facilitaba ataques de “la palabra probable”. La segunda fue que siendo en su mayoría mensajes rutinarios, cada uno de ellos aportaba poca información, pero todos juntos permitían conocer el funcionamiento de cada unidad y de todas las fuerzas alemanas al detalle, de hecho con el mismo detalle que los mandos alemanes en sus cuarteles generales. Esos mensajes en concreto parecían antiguos, de tiempos de paz, pero no veía razón por la que las conclusiones no pudieran aplicarse también ahora.</p>
<p>Sería estimulante suponer que le especialidad de Whelchman en investigación de álgebras geométricas influyó en su aproximación inductiva al problema. En lugar de comenzar a aplicar la teoría de grupos, como había sido el reflejo de todos los matemáticos hasta ese momento, prefirió husmear por las configuraciones de Enigma con lo que los psicoanalistas llaman “curiosidad flotante”, es deci,r fijarse en lo que llama la atención sin concentrarse en nada predeterminado hasta estar seguro de que se va a morder algo sólido. Había una tipología muy llamativa, que después se llamó “de las hembras” como aliteración inglesa de la expresión usada originalmente por los polacos. Como Cooper le había dicho, los alemanes repetían la clave dos veces en el indicador, por lo que la primera letra y la cuarta, la segunda y la quinta y la tercera y la sexta, representaban la misma letra en claro. A veces estas letras eran iguales, es decir que el producto de la codificación de una letra  determinada daba dos veces la misma letra en dos configuraciones de Enigma separadas por tres posiciones. Tras un mes y medio viendo indicadores sabía que no era una configuración insólita, pero tampoco tan habitual como para no fijarse cuando se veía una. Whelchman se interrogó sobre la probabilidad de ocurrencia de las hembras. </p>
<p>Una vez colocadas las ruedas, todas las posiciones de Enigma son consecutivas. Enigma es un sistema de codificación polialfabético, que para cada posición de las ruedas dispone de 17.576 alfabetos consecutivos. Para que se dé un resultado hembra hace falta que dos de estos alfabetos, separados entre sí por tres posiciones, compartan una pareja de transposiciones, es decir que los dos conviertan p.ej. la R en J. Esto es una limitación muy fuerte y Whelchman pensó que era una forma de identificar tanto el grupo de alfabetos usado (es decir la posición de las ruedas en los huecos) como el punto exacto en la sucesión de éstos en la que se había codificado la clave. Se interrogó sobre hasta qué punto eso era algo característico que facilitara el trabajo.</p>
<p>¿Cuál es la probabilidad de que dos alfabetos compartan alguna transposición? La probabilidad de cada transposición es 1/25, ya que cada letra puede estar asociada con cualquiera de las otras 25. Por causa del reflector, si A da G en un alfabeto, en ese mismo alfabeto G dará A, así que existen 13 transposiciones por alfabeto. Por tanto la probabilidad de que en dos alfabetos haya la misma transposición es de 13/25, o sea, más o menos ½.  ¿Cuál es la probabilidad de que metamos justamente la letra que comparten? Es 1/13, ya que nuevamente la simetría de Enigma hace que si dos alfabetos dan un resultado hembra para una letra que se entre, también lo den si se introduce como entrada la letra cifrada que corresponde a ésta. Así que la probabilidad de que la primera y la cuarta letras sean la misma es 13/25 multiplicado por 1/13, es decir 1/25. Como la clave tiene tres letras, tenemos tres oportunidades y por tanto la probabilidad de obtener una hembra es de 3/25, aproximadamente un mensaje de cada ocho, más o menos lo que le indicaba su experiencia.</p>
<p>Lo que acababa de demostrar era que cada hembra sólo permitía descartar la mitad de los alfabetos de Enigma, por lo que la criba de posibilidades no había sido muy grande. Sin embargo se dio cuenta con estupefacción de que si dos alfabetos separados por tres posiciones daban una hembra, lo harían también (aunque con otras letras) aunque las letras en claro estuviesen afectadas por conectores del panel. Whelchman estaba muy sorprendido de haber encontrado algo no afectado por el maléfico panel, ya que esto dividía el problema por 200 billones. No olvidemos que el panel era lo que impedía el rodding de Knox, y que esto lo rodeaba de un cierto aura de invencibilidad.</p>
<p>Pero había encontrado algo más que eso. Muy pronto, y en medio de una gran agitación, Whelchman concluyó que la aplicación de cribas sucesivas, cada una producto de una hembra en un mensaje diferente, eliminaría sucesivamente ½, 3/4, 7/8, 15/16, 31/32, etc... Es decir que los cien mensajes que fácilmente podía reunir en un día cualquiera, producirían 12 hembras de cada clave, que -todas juntas- reducirían las pruebas necesarias a 17.576/4.096. La conclusión era devastadora: si encontraba una forma de hacer el análisis deprisa, sólo harían falta 4 pruebas para cada una de las 60 posiciones de las ruedas. O sea, 240 pruebas al día en el peor de los casos para leer todo el tráfico alemán de esa red, en lugar de los miles de millones que se suponían necesarias. Por muchas vueltas que le dio al razonamiento, en medio de su propia incredulidad, no encontró ningún fallo.</p>
<p>Con un premio de ese tamaño al alcance, Whelchman afiló su lapiz y se aprestó a analizar todas las alternativas posibles para realizar la criba de mensajes con las hembras de una forma rápida, lo cual no estaba claro que fuese posible. “Quizás ese sea el fallo -pensó-. Quizás no sea posible analizarlas todas más que una por una”. Pero Whelchman tenía el espíritu y la constancia de los matemáticos acostumbrados a golpear paredes durante meses a la espera que caiga un ladrillo que permita desmontarlas, o a navegar sobre kilómetros de pizarras por bosques de ecuaciones tratando de despejar y eliminar algún conjunto de términos recalcitrante. Empezó a mostrar los síntomas de Knox y Cooper, vagando abstraido por el jardín para apuntar de pronto frenéticamente algo en una libreta que sacaba del bolsillo. </p>
<p>El problema era almacenar las hembras para poder compararlas de forma fácil. Como queremos utilizar las hembras cualesquiera que sea la letra, no hace falta que guardemos esa información. Tenemos por tanto cuatro dimensiones para caracterizar una ocurrencia: la posición de las ruedas en los tres huecos y la posición inicial de cada una de ellas. Si hacemos un análisis separado de cada posición en los huecos, lo cual parece impecable pues en eso se ha basado todo el razonamiento hasta aquí, sólo quedan tres. Podemos tomar hojas de papel y llamar a cada una como cada una de las 26 posiciones iniciales de la rueda lenta. En las dos dimensiones que quedan representamos una cuadrícula, que en las abcisas tenga las posiciones de la rueda media y las ordenadas de la rueda rápida. Podemos marcar las posiciones hembras con una cruz.</p>
<p> Desgraciadamente no conocemos la configuración de anillo de la rueda lenta, por lo que deberíamos hacer 26 juegos, uno para cada posición de los anillos de dicha rueda. Pero como  las configuraciones de anillo sólo enmascaran la verdadera posición de la rueda, las 676 hojas resultantes serían en realidad 26 hojas repetidas 26 veces, así que basta con tener eso en cuenta y usar 26 veces con diferentes valores para representar las 26 posiciones que el anillo puede tener para cada posición de la llanta. </p>
<p>En algún momento tuvo ese “eureka” que es el sueño dorado de su profesión, ese momento en que las brumas se despejan de pronto y el resultado resplandece. Si en lugar de cruces hacemos un agujero, si ponemos las hojas unas encima de las otras separadas entre sí por la distancia que determinan las letras de los anillos enviadas en claro, al ir añadiendo hojas irán desapareciendo agujeros, puesto que sólo algunas posiciones serán compatibles con las hembras que han aparecido. Si la configuración de anillos de la rueda lenta que estamos probando no es correcta, todos los agujeros desaparecerán y pasaremos a la siguiente. Normalmente doce hojas serán suficientes. Tal y como había demostrado, para cada configuración de las ruedas en los huecos sólo cuatro configuraciones de anillo serían posibles. Probando una vez para cada una de las 60 formas de poner las ruedas en los huecos quedarían 240 posiciones de los anillos para probar. Algo al alcance, y después de lo cual ya tenemos la configuración de anillos correcta. Sólo queda usarla para saber las claves y todos los mensajes del enemigo están en nuestra mano con sólo dar las claves a una legión de operadores, armados cada uno con una réplica de Enigma. </p>
<p>Nuevamente repasó todo febrilmente en su mesa porque ahora sí que le aterrorizaba estar equivocado. Cuando ya no sabía cómo mirarlo, se levantó y corrió más que anduvo hasta la granja junto a la mansión en la que estaba el grupo de Dilly Knox. Knox le escuchó un rato y luego montó en cólera. ¿Quién le había dicho que hiciera eso? Había otras personas haciéndolo y desde luego que habían llegado a las mismas conclusiones. Para su información, quizás le interesaría saber que se estaban perforando hojas en ese mismo momento. ¿Por qué no hacía el favor de volver a su trabajo y comportarse de una forma disciplinada?</p>
<p>Por mucho que Whelchman le dio vueltas al tema no encontró justificación a la actitud de Knox. Incluso el más recalcitrante egocéntrico se habría sentido halagado de poder mostrar que lo había descubierto antes. ¿A qué venía enfadarse? Y si lo que le preocupaba era que no quería compartirlo con Whelchman por motivos de seguridad, ¿qué podía ser más absurdo que confirmarle a gritos que era verdad? Habría sido más normal llevarle a pasear un momento y pedirle discreción. Había algo raro en la forma de reaccionar de Knox que impidió que Whelchman se ofendiera. Y además, ¿de dónde había sacado Knox el cableado de las ruedas para poder componer las tablas?</p>
<p>El secreto que explicaba aquel comportamiento era una reunión a la que había asistido Knox, junto con Denniston y Bertrand pocas semanas antes. La reunión había tenido lugar en Cabati, junto al bosque de Pyri y a pocos kilómetros de Varsovia, en la sede del BS4 polaco.</p>
<p> </p>
<p><span class="geshifilter"><code class="text geshifilter-text">© Román Ceano. Todos los derechos reservados.</code></span></p>
<p> </p>
</div></div></div>
<footer id="book-navigation-36" class="book-navigation"><div class="page-links clearfix">
<a href="https://kriptopolis.github.io/enigma/enigma-27.html" class="page-previous" title="Ir a la página anterior">‹ Enigma 27</a><a href="https://kriptopolis.github.io/enigma/" class="page-up" title="Ir a la página madre">Índice</a><a href="https://kriptopolis.github.io/enigma/enigma-29.html" class="page-next" title="Ir a la página siguiente">Enigma 29 ›</a>
</div></footer>
</div></article></section>
</div></body>
</html>
