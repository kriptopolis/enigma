<!DOCTYPE html><html lang="es">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Enigma 49 | Kriptópolis</title>
<meta charset="utf-8">
<meta content="Enigma 49" about="/enigma-49" property="dc:title">
<meta about="/enigma-49" property="sioc:num_replies" content="0" datatype="xsd:integer">
<meta name="Generator" content="Drupal 7 (http://drupal.org)">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="MobileOptimized" content="width">
<meta name="HandheldFriendly" content="true">
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="next" href="https://kriptopolis.github.io/enigma/enigma-50.html">
<link rel="prev" href="https://kriptopolis.github.io/enigma/enigma-48.html">
<link rel="shortcut icon" href="https://kriptopolis.github.io/favicon.ico" type="image/x-icon">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css">
<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css">
<link type="text/css" rel="stylesheet" href="https://kriptopolis.github.io/enigma/style.css">
</head>
<body><div class="container">
<header id="header" class="clearfix"><div id="branding">
<div id="logo"><a href="https://kriptopolis.github.io/" title="Página de inicio"><img src="https://kriptopolis.github.io/kriptopolis.png" alt="Kriptópolis logo"></a></div>
<hgroup><h1 id="site-name"><a href="https://kriptopolis.github.io/" title="Página de inicio">Kriptópolis</a></h1>
<h2 id="site-slogan">Criptografía y Seguridad</h2></hgroup>
</div>
<!-- /header region --></header><section id="main-content"><header class="clearfix"><h1 id="page-title">Enigma 49</h1></header><article id="article-220" class="article article-type-book article-lang-es odd article-full clearfix" about="/enigma-49" typeof="sioc:Item foaf:Document" role="article"><footer class="submitted"><span property="dc:date dc:created" content="2012-06-03T11:42:11+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/89" typeof="sioc:UserAccount" property="foaf:name" datatype="">Roman</span> en <time datetime="2012-06-03T11:42:11Z" pubdate="pubdate">Dom, 03/06/2012 - 11:42am</time></span></footer><div class="article-content">
<div class="field field-name-body field-type-text-with-summary field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded">
<p><em>Por Román Ceano</em></p>
<p>A partir de ese momento, BTM permitió a Keen dedicarse a CANTAB (el nombre que le asignaron al proyecto en la fábrica) en exclusiva. Éste decidió desentenderse del problema lógico -suponiendo con acierto que de eso ya se ocuparían los matemáticos- para intentar crear un aparato lo más versátil posible, capaz de actuar de muchas maneras diferentes. Para ello montaría las Enigmas abiertas (llamadas por Turing en su futuro manual de operación "Enigmas de Levenworth", por el nombre de la ciudad donde estaba la fábrica BTM), formadas por tres ruedas colocadas verticalmente en columna -como un semáforo- en filas sobre un rack pero desconectadas entre sí. </p>
<p>Las ruedas tendrían cuatro círculos de contactos en el mismo lado, cableados para simular la circuitería de los rotores de Enigma. De esta manera la electricidad podía pasar dos veces por cada rueda al igual que en la Enigma real, sólo que aquí lo hacía por caminos separados en lugar de hacerlo como ida y vuelta. Como había cinco cableados distintos, haría falta fabricar tantos juegos de cinco ruedas como Enigmas contuviera la bomba. La rueda más baja de cada Enigma abierta sería la rueda rápida, la de enmedio la media  y la de arriba la lenta. Todas las Enigmas de un mismo rack girarían sincronizadamente y en movimientos discretos. Afortunadamente, ésta era una de las tecnologías que más dominaba BTM, puesto que sincronizar movimientos y lecturas era imprescindible para trabajar con las tarjetas Holleritz.</p>
<p>En la parte trasera estaban las entradas y salidas de las Enigmas, que iban soldadas a un conector de 26 pines. Mediante cables de 26 hilos con el mismo tipo de conector se podría unir unas  con otras o llevar las entradas o salidas a unos paneles donde se podían cruzar los hilos a voluntad. </p>
<p>El prototipo de esta Bomba resultó bastante dificil de realizar en la práctica y a pesar de que en los archivos de BP se conservan notas que afirman que en Noviembre de 1939 ya estaba montándose, la verdad es que el primer equipo no fue instalado allí hasta el 18 de Marzo del año siguiente. Sólo contenía 10 Enigmas abiertas,</p>
<p>La idea convencional que uno tiene de cómo usar la bomba es tomar una palabra probable y encajarla con el trozo de texto en el que va. Esto nos determina un número de correspondencias ordenadas igual a la longitud de la palabra probable (p.e. posición 1 a-&gt;Z, posición 2 j-&gt;N, posición 3 b-&gt;X, etc..). Bastará con conectar sucesivamente tantas Enigmas abiertas como letras tenga la palabra probable, teniendo la precaución de que la supuesta letra de salida de cada una esté enchufada a la supuesta letra de entrada de la siguiente. </p>
<p>Entonces cada Enigma abierta se adelanta tantos órdenes de ruedas como su posición relativa para simular los avances que tuvieron lugar cuando se cifró el mensaje. Basta ponerla en marcha y cuando la electricidad pasa por todas ellas, detenerla y comprobar la posición de la primera, ya que hemos hallado una serie de alfabetos sucesivos que cumple las correspondencias determinadas por la relación texto en claro-criptotexto. Aunque hay que hacerlo para cada orden posible de las ruedas, se trata de un ataque de fuerza bruta infalible. En caso que se hallen varios órdenes de ruedas y/o varias posiciones iniciales compatibles, se procede a probarlas en una réplica de Enigma con el resto del mensaje, pero la probabilidad de que haya más de uno si la palabra probable es larga es infinitesimal.</p>
<p>Desgraciadamente, esta aproximación adolece del mismo fallo que el rodding y por las mismas razones. El panel de conexionado, que recordemos utilizaban las Enigmas militares, enmascara la relación texto en claro-criptotexto e imposibitlita el ataque. Como se ha dicho, Turing era consciente de esto y había sido su principal preocupación desde el principio. Cuando Keen se presentó con su Bomba, bautizada “Victory” de forma quizás demasiado optimista, ya había encontrado la solución, pero había fracasado en su intento de implementarla. </p>
<p>La solución que Turing había estado intentando implementar consiste en buscar ciclos en las parejas determinadas por la relación texto en claro-criptotexto. Estos ciclos consisten en series de parejas en las que cada una termine como empieza la siguiente y que la última pareja termine como empieza la primera, cerrando el círculo. (p.e. posición 1 b-&gt;J, posición 7 j-&gt;N, posición 4 N-&gt;b.)  </p>
<p>Si tenemos varios ciclos que tengan una letra en común (llamada "central" en la jerga de Turing) podemos construir un grafo con todos ellos. Estos grafos tienen la virtud de que permiten averiguar si la letra central está o no conectada a otra en el panel de conexionado. De hecho lo que permiten es descartar muchas posibles conexiones, de manera que por reducción al absurdo sólo quedan algunas (o con suerte sólo una). Si suponemos que en la Enigma con la que se cifró el texto, la R estaba conectada a la C (es decir que al pulsar R esta entraba en Enigma como C y cuando salía C se encendía la bombilla R), utilizando dos o tres ciclos de este tipo -que utilicen una de estas letras- podemos buscar cadenas de implicaciones incompatibles y descartar esa posibilidad.</p>
<p>La forma de hacerlo usando la Bomba es conectar varios juegos de Enigmas abiertas, tantos como ciclos tengamos, y con tantas cada uno como letras contenga el ciclo. Una vez conectadas, se configuran las ruedas rápidas con un decalaje que sea el mismo que la distancia entre las posiciones de Enigma que produjeron las transposiciones correspondientes a cada una de las parejas que forman el ciclo. A continuación se conecta electricidad a la entrada de la primera Enigma en una de las letras. Finalmente se ponen en marcha todas las cadenas a la vez y se hace que recorran todos los alfabetos posibles (para cada uno de los órdenes de ruedas, lo que implica o bien 60 montajes y desmontajes o bien varias pruebas simultáneas hasta agotar el número de Enigmas abiertas disponibles).</p>
<p>Como quiera que estos ciclos son inmunes al panel de conexionado a causa de la naturaleza recíproca de éste, si en algún momento se cumplen las condiciones de todos los ciclos la corriente pasa a través de todo el circuito. Esto significa que la letra central de todos los ciclos están conectada en el panel de conexionado a la letra en la que se estuviera entrando la corriente en ese momento. </p>
<p>Basta probar sistemáticamente las 26 letras para saber si la letra central de los ciclos está o no conectada a otra (si no está conectada a ninguna otra, se cierra el circuito cuando metemos corriente en esa letra y entonces decimos en la jerga de Turing que esa letra está "autoconectada"). Esta prueba produce también en las Enigmas intermedias las conexiones del panel de todas las letras implicadas  en el ciclo, además de una posición inicial de las ruedas. Así pues obtenemos de un solo golpe varias letras afectadas por el panel de conexionado, junto con la posición de las ruedas con la que se cifró el mensaje. Aunque muchas veces obtenemos varias posibilidades, basta con probarlas en una réplica de Enigma para hallar la correcta. </p>
<p>Mientras Keen construía el prototipo Victory, Turing buscaba la forma de reducir el número de pruebas necesarias. Aunque apenas han quedado rastros de ello, parece que contactó con una empresa llamada Pye en Cambridge para que construyera algunos circuitos que añadidos a la Bomba de Keen permitirían realizar muchas pruebas de consistencia con los ciclos de una sola pasada. Turing dejó anotado de pasada que los ingenieros implicados tuvieron muchos problemas de desarrollo ya que debían desarrollar gran cantidad de tecnología. Cuando Keen ya había terminado, éstos apenas estaban empezando. </p>
<p>Lo que sucedió a continuación fue que Whelchman hizo su segunda gran contribución al éxito de BP. Turing buscaba lo que él llamaba el "escaneado simultáneo", que evitara tener que probar las hipotésis sobre el conexionado una por una. Whelchman descubrió un sistema sorprendentemente simple. El truco está en darse cuenta de que cuando metemos corriente a una letra de la primera Enigma de cada grupo que representa un ciclo, las otras letras no se están utilizando. Si conectamos todas las salidas de la última Enigma del ciclo a todas las de la primera, como la corriente que sale sin duda por alguna letra de la última vuelve a entrar por la primera, muchas hipótesis se prueban a la vez gracias a la naturaleza recíproca de Enigma. </p>
<p>El resultado neto es que si conectamos bombillas a los circuitos resultantes, en la inmensa mayoría de los casos se encenderán todas. Pero existirá un grupo de sub-casos en los que esto no pasará. A veces, o bien se encenderán todas menos una o bien sólo una. En estos casos, la que se comporta diferente es la candidata a estar conectada con aquella que era común a todos los ciclos.  Al igual que antes, no sólo tenemos una posición inicial de las ruedas, sino también varias de las letras afectadas por el panel de conexionado y a qué letras están conectadas. En la Bomba, en lugar de bombillas se utilizaban para detener la prueba relés, conectados de forma que operasen con esta lógica.</p>
<p>El cableado adicional propuesto por Whelchman pasó a llamarse Tablero Diagonal. Que comprender su utilidad no es algo trivial lo ilustra el hecho de que a Turing le costó un tiempo aceptar que realmente permitía el escaneo simultáneo. Las fuentes divergen sobre cuánto tardó en darse cuenta. Algunos dicen que fueron días, pero Joan Clark, recién asignada al Cobertizo 8 afima que sólo fueron unos minutos. En cualquier caso, la complejidad del circuito resultante es tal que resulta imposible dibujarlo con una mínima claridad y sólo usando diagramas de una Enigma que maneje pocas ruedas es posible atisbar la estructura de la configuración. (Este cronista confiesa que sólo tras largas horas de dura reflexión  ha conseguido a veces vislumbrar algo por entre la niebla de su propia estulticia) </p>
<p>Keen fue enviado de nuevo a su taller para hacer un prototipo que incorporase el Tablero Diagonal. Hasta ocho ingenieros participaron en  la confección del nuevo prototipo, que quedó listo el 10 de Agosto de 1940, pocos días antes de que empezara la fase crucial de la Batalla de Inglaterra.</p>
<p>Éste disponía de 12 Enigmas abiertas y fue llamado oficialmente Agnus Dei, el Cordero de Dios. Sin embargo, en el ambiente informal de BP pronto fue rebautizado como "Agnes" o La Araña, a causa del entramado infernal de cables que lucía su parte trasera. Estos cables dejaron una honda impresión en los testigos a los que se permitió una fugaz visita al Cobertizo que contenía la Bomba. Algunos los equiparaban a los de un jersey tejido de forma enloquecida con lanas de muchos colores. </p>
<p>Es curioso que incluso el detalle del color de los cables está envuelto en el misterio. A pesar de que los investigadores modernos afirman que todos eran o rojos o negros, como se ha dicho no falta quien recuerda manojos de cables multicolores. Como quiera que ni tan sólo es posible saber cuántos prototipos de cada modelo se construyeron (uno o dos según las fuentes), ni cuándo cada testigo los vio, no hay forma de aclarar este punto, que resulta ilustrativo de lo engañosa que puede ser la memoria (o de lo fútil de las investigaciones si los testigos tienen razón). </p>
<p>En el capítulo de incertidumbres hemos de señalar también que el hijo de Keen afirma que hubo un prototipo mucho más primitivo, previo al Victory. En caso de que existiera, nunca fue trasladado a BP y nadie más que su autor tuvo noticia de él. En BP sólo se registraron oficialmente las entradas de la Victory en Marzo y la Agnus Dei (Agnes o Araña) en Agosto. </p>
<p>Mientras la aviación británica luchaba su batalla desesperada en los cielos de la Isla, los criptoanalistas comprobaron con satisfacción que el concepto funcionaba perfectamente. Algunos mensajes del Mayo anterior -único mes para el que se disponía de claves que permitieran suplir la falta de tablas de dígrafos- que ya habían sido rotos tras penosas y largas pruebas con la Victory, cayeron ahora en muchísimo menos tiempo. Keen volvió nuevamente a su taller, pero ahora ya no dependía de otros.  </p>
<p><img src="https://kriptopolis.github.io/enigma/pics/enigma/bomba.jpg" align="right" hspace="12" alt="Bomba de Octubre">Revisó y racionalizó todo el diseño mejorando cientos de detalles a la luz de la experiencia obtenida en los montajes anteriores. Decidió que montaría tres filas de doce Enigmas cada una, con lo que se obtenían 36, muy cerca de las 40 sugeridas por Twin. Con el Tablero Diagonal, que permitía el escaneo simultáneo, la potencia sería mucho mayor de lo previsto en las reuniones de los pubs para una Bomba de 40. En Octubre entregó en BP el primer modelo industrial, mientras la BTM comenzaba a preparar la producción en masa.</p>
<p> </p>
<pre>© Román Ceano. Todos los derechos reservados.</pre>
<p> </p>
</div></div></div>
<footer id="book-navigation-36" class="book-navigation"><div class="page-links clearfix">
<a href="https://kriptopolis.github.io/enigma/enigma-48.html" class="page-previous" title="Ir a la página anterior">‹ Enigma 48</a><a href="https://kriptopolis.github.io/enigma/" class="page-up" title="Ir a la página madre">Índice</a><a href="https://kriptopolis.github.io/enigma/enigma-50.html" class="page-next" title="Ir a la página siguiente">Enigma 50 ›</a>
</div></footer>
</div></article></section>
</div></body>
</html>
